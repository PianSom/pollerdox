<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/pollerdox/blog/rss.xml" title="Unifi Poller Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/pollerdox/blog/atom.xml" title="Unifi Poller Blog Atom Feed"><title data-react-helmet="true">Docker - using docker-compose | Unifi Poller</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Docker - using docker-compose | Unifi Poller"><meta data-react-helmet="true" name="description" content="This page assumes that you have decided to start Unifi Poller using docker-compose. The setup detailed below will install containers for Unifi Poller, Grafana and InfluxDB"><meta data-react-helmet="true" property="og:description" content="This page assumes that you have decided to start Unifi Poller using docker-compose. The setup detailed below will install containers for Unifi Poller, Grafana and InfluxDB"><meta data-react-helmet="true" property="og:url" content="https://unifi-poller.github.io/pollerdox/docs/ins2"><link data-react-helmet="true" rel="shortcut icon" href="/pollerdox/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://unifi-poller.github.io/pollerdox/docs/ins2"><link rel="stylesheet" href="/pollerdox/styles.21f0090d.css">
<link rel="preload" href="/pollerdox/styles.6490030f.js" as="script">
<link rel="preload" href="/pollerdox/runtime~main.37e3cbe9.js" as="script">
<link rel="preload" href="/pollerdox/main.ee9b95e7.js" as="script">
<link rel="preload" href="/pollerdox/1.3f7b50f0.js" as="script">
<link rel="preload" href="/pollerdox/2.19917554.js" as="script">
<link rel="preload" href="/pollerdox/30.4bc06e3f.js" as="script">
<link rel="preload" href="/pollerdox/31.a615a306.js" as="script">
<link rel="preload" href="/pollerdox/935f2afb.0cbc211c.js" as="script">
<link rel="preload" href="/pollerdox/17896441.00fe3a72.js" as="script">
<link rel="preload" href="/pollerdox/57e85107.a9bd946d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/pollerdox/"><img src="/pollerdox/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/pollerdox/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Unifi Poller</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pollerdox/docs/up1">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/pollerdox/"><img src="/pollerdox/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/pollerdox/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Unifi Poller</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/pollerdox/docs/up1">Docs</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">UnifiPoller</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pollerdox/docs/up1">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pollerdox/docs/up2">How it works</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pollerdox/docs/up3">FAQs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pollerdox/docs/up4">Easy starting point</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Installation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins1">Getting started</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/pollerdox/docs/ins2">Docker - using docker-compose</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins3">Docker - using command line</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins4">Docker - FAQs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins5">Bare metal - FreeBSD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins6">Bare metal - Linux/MacOS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins7">Bare metal - Windows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins8">NAS - Synology</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins9">Config file and Environment variables</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins10">Final steps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins11">Prometheus support</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins12">Loki</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins13">InfluxDB and Grafana Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pollerdox/docs/ins14">Web server</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pollerdox/docs/tro1">Common solutions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pollerdox/docs/tro2">Getting help</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Thanks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pollerdox/docs/thx1">Contributors</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Docker - using docker-compose</h1></header><div class="markdown"><p>This page assumes that you have decided to start Unifi Poller using <code>docker-compose</code>. The setup detailed below will install containers for Unifi Poller, Grafana and InfluxDB</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="before-this"></a>Before this<a class="hash-link" href="#before-this" title="Direct link to heading">#</a></h2><p>Make sure you have set up a user on your controller for Unifi Poller to use</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="installing-the-unifi-poller-package-for-docker"></a>Installing the Unifi Poller package for Docker<a class="hash-link" href="#installing-the-unifi-poller-package-for-docker" title="Direct link to heading">#</a></h2><p> Unifi Poller&#x27;s Docker container can be configured for use in two ways:</p><ul><li>by using environment variables or</li><li>via a configuration file</li></ul><p>Which to use is a matter of personal choice. The environmental path has the advantage that all settings are in one place (albeit a hidden file, and one where all information is available to all containers). The config file method has the advantage that Unifi Poller specific settings can be saved in the same shared Docker folder as the rest of the app&#x27;s data.</p><p>There is a detailed description of the configuration parameters in [Config file and Environment variables] (ins9.md) below.</p><p>Both of the alternatives described here will pull containers not just for Unifi Poller, but also for InfluxDB and Grafana. If you wish to use existing instances then amend the files as necessary.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="alternative-1---using-environment-variables"></a>Alternative 1 - Using environment variables<a class="hash-link" href="#alternative-1---using-environment-variables" title="Direct link to heading">#</a></h4><p>In order to pass environment variables via <code>docker-compose</code> you need to have a file called <code>.env</code> in the same folder as the <code>docker-compose</code> yaml file</p><ul><li>Copy the example <a href="https://github.com/unifi-poller/unifi-poller/blob/master/init/docker/docker-compose.env.example" target="_blank" rel="noopener noreferrer">environment file</a></li><li>Edit it as necessary (in particular ensure that <code>UNIFI_USER</code> and <code>UNIFI_PASS</code> are set)</li><li>Save it as <code>.env</code> in the same folder as your <code>docker-compose.yml</code> (if you have one; if not see below)</li></ul><p>Download the <a href="https://github.com/unifi-poller/unifi-poller/blob/master/init/docker/docker-compose.yml" target="_blank" rel="noopener noreferrer">example</a> <code>docker-compose.yml</code> and add it to your existing one (if you have one; if not just make sure it is saved in the same folder as the <code>.env</code> file)</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="alternative-2---using-a-configuration-file"></a>Alternative 2 - Using a configuration file<a class="hash-link" href="#alternative-2---using-a-configuration-file" title="Direct link to heading">#</a></h4><p>Alternatively, if you choose to use a configuration file</p><ul><li>Copy the example <a href="https://github.com/unifi-poller/unifi-poller/blob/master/examples/up.conf.example" target="_blank" rel="noopener noreferrer">config file</a></li><li>Edit it as necessary (in particular ensure that the <code>[unifi]</code>/<code>user</code> and <code>pass</code> variables are set)</li><li>Save it as <code>unifi-poller.conf</code> in the local location you use for Docker storage in a folder called <code>unifi-poller</code></li></ul><div class="admonition admonition-important alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</h5></div><div class="admonition-content"><p>Whichever alternative you choose make sure that you do <strong>not</strong> include <code>:8443</code> on the url of the controller if you are using <code>unifios</code> (that is, a UDM-Pro, UDM, or Ckoudkey with modern firmware)</p></div></div><p>Add the following to your <code>docker-compose.yml</code> after amending <code>YOURLOCALPATH</code> to be the local location you use for Docker storage</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">version: &quot;3&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">services:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  influxdb:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    container_name: up_influxdb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    restart: unless-stopped</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    image: influxdb:1.8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ports:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - &#x27;8086:8086&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    volumes:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - /YOURLOCALPATH/influxdb:/var/lib/influxdb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    environment:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - INFLUXDB_DB=unifi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - INFLUXDB_ADMIN_USER=unifi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - INFLUXDB_ADMIN_PASSWORD=unifi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  grafana:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    container_name: up_grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    image: grafana/grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    restart: unless-stopped</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ports:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - &#x27;3000:3000&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    volumes:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - /YOURLOCALPATH/grafana:/var/lib/grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    depends_on:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - influxdb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    environment:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - GF_SECURITY_ADMIN_USER=admin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - GF_INSTALL_PLUGINS=grafana-clock-panel,natel-discrete-panel,grafana-piechart-panel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  unifi-poller:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    container_name: up-poller</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    restart: unless-stopped</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    image: golift/unifi-poller:latest</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    depends_on:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - influxdb</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - grafana</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    volumes:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - /YOURLOCALPATH/unifi-poller:/config</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="starting-up"></a>Starting up<a class="hash-link" href="#starting-up" title="Direct link to heading">#</a></h2><p>Whichever alternative you chose, all that is need to pull the containers and start them is a simple
<code>docker-compose up</code></p><p>If all has worked then after it has downloaded and started you should start seeing lines like</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">unifi-poller    | 2020/06/18 12:08:50 [INFO] UniFi Metrics Recorded. Sites: 1, Clients: 67, UAP: 6, USG/UDM: 1, USW: 5, IDS Events: 0, Points: 1837, Fields: 11307, Errs: 0, Elapsed: 599ms</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>If you don&#x27;t see this then go back and check what you have done so far</p><p>Finally, start the containers in a daemonised fashion, just stop the <code>docker-compose</code> and run <code>docker-compose up -d</code></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="next-steps"></a>Next steps<a class="hash-link" href="#next-steps" title="Direct link to heading">#</a></h2><p>Go to the section <a href="/pollerdox/docs/ins10">Final steps</a></p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/pollerdox/docs/ins1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Getting started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/pollerdox/docs/ins3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Docker - using command line Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#before-this" class="table-of-contents__link">Before this</a></li><li><a href="#installing-the-unifi-poller-package-for-docker" class="table-of-contents__link">Installing the Unifi Poller package for Docker</a></li><li><a href="#starting-up" class="table-of-contents__link">Starting up</a></li><li><a href="#next-steps" class="table-of-contents__link">Next steps</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/XNQSYwYH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Project home</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/unifi-poller/unifi-poller" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021</div></div></div></footer></div>
<script src="/pollerdox/styles.6490030f.js"></script>
<script src="/pollerdox/runtime~main.37e3cbe9.js"></script>
<script src="/pollerdox/main.ee9b95e7.js"></script>
<script src="/pollerdox/1.3f7b50f0.js"></script>
<script src="/pollerdox/2.19917554.js"></script>
<script src="/pollerdox/30.4bc06e3f.js"></script>
<script src="/pollerdox/31.a615a306.js"></script>
<script src="/pollerdox/935f2afb.0cbc211c.js"></script>
<script src="/pollerdox/17896441.00fe3a72.js"></script>
<script src="/pollerdox/57e85107.a9bd946d.js"></script>
</body>
</html>